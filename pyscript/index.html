<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Drafter Website</title>
        <link rel="stylesheet" href="https://pyscript.net/releases/2025.7.2/core.css">
        <script type="module" src="https://pyscript.net/releases/2025.7.2/core.js"></script>

        <py-config>
            {
                "packages": ["drafter", "pillow"],
                "files": {
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/__init__.py": "././drafter/__init__.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/configuration.py": "././drafter/configuration.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/debug.py": "././drafter/debug.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/files.py": "././drafter/files.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/history.py": "././drafter/history.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/page.py": "././drafter/page.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/raw_files.py": "././drafter/raw_files.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/server.py": "././drafter/server.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/styling.py": "././drafter/styling.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/urls.py": "././drafter/urls.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/components.py": "././drafter/components.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/constants.py": "././drafter/constants.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/deploy.py": "././drafter/deploy.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/hacks.py": "././drafter/hacks.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/image_support.py": "././drafter/image_support.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/py.typed": "././drafter/py.typed",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/routes.py": "././drafter/routes.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/setup.py": "././drafter/setup.py",
                    "https://raw.githubusercontent.com/codeBodger/drafter/refs/heads/use-pyscript-codeBodger/drafter/testing.py": "././drafter/testing.py"
                }
            }
        </py-config>
    </head>

    <body>
        <div id="website">
            Loading...
        </div>

        <script type="py">
            from pathlib import Path
            def write(filename, contents):
                output_file = Path(filename)
                output_file.parent.mkdir(exist_ok=True, parents=True)
                output_file.write_text(contents)
            write('main.py', '#!/bin/python\n\n# import sys\n# sys.path.insert(0, "/home/rowan/Desktop/CISC/CS1/drafter-pyscript/")\n\nfrom drafter import route, Page, Button, start_server, __version__, deploy_site, get_main_server, Table, add_files\nfrom dataclasses import dataclass\n\nfrom random import randint\n\n@dataclass\nclass State:\n        counter: int\n\n@route\ndef index(state: State) -> Page:\n        return Page(state, [Table([\n                ["Welcome to Drafter!",\n                "Click the button below."],\n                [Button("Increase the count", increment_counter, (randint(1,100),))],\n        ])])\n\n@route\ndef increment_counter(state: State, offset: int) -> Page:\n        raise ValueError("aa")\n        state.counter += offset\n        return Page(state, [\n                "You\'ve clicked the button " + str(state.counter) + " times",\n                Button("Click again", increment_counter, (randint(1,100),))\n        ])\n\nprint(__version__)\n\nadd_files(\n    "./drafter/__init__.py",\n    "./drafter/configuration.py",\n    "./drafter/debug.py",\n    "./drafter/files.py",\n    "./drafter/history.py",\n    "./drafter/page.py",\n    "./drafter/raw_files.py",\n    "./drafter/server.py",\n    "./drafter/styling.py",\n    "./drafter/urls.py",\n    "./drafter/components.py",\n    "./drafter/constants.py",\n    "./drafter/deploy.py",\n    "./drafter/hacks.py",\n    "./drafter/image_support.py",\n    "./drafter/py.typed",\n    "./drafter/routes.py",\n    "./drafter/setup.py",\n    "./drafter/testing.py"\n)\n\nstart_server(State(0))\n')
            write('main2.py', 'from drafter import Button, Argument\nfrom pyscript import document\nfrom typing import Any\n\ndef make_button(event: Any) -> None:\n    input_text = document.querySelector("#text")\n    text = input_text.value\n    output_div = document.querySelector("#output")\n    output_div.innerHTML = str(Button(text, str))\n\n    Argument(3, 3)\n')

            import os
            os.environ.setdefault("DRAFTER_PYSCRIPT", "True") # ensure correct config

            import main
            from drafter import get_main_server
            from pyscript import document

            server = get_main_server()
            document.getElementById("website").innerHTML = \
                server.routes['/'](server._state, server._page_history)
        </script>
    </body>
</html>
