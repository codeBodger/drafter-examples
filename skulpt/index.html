<!DOCTYPE html>
<html>
    <head>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js" type="text/javascript"></script>
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"
        ></script>
        <script type="text/javascript">
            let pythonSource = {};
            pythonSource['main.py'] = '#!/bin/python\n\n# import sys\n# sys.path.insert(0, "/home/rowan/Desktop/CISC/CS1/drafter-skulpt/")\n\nfrom drafter import route, Page, Button, start_server, __version__, deploy_site, get_main_server, Table\nfrom dataclasses import dataclass\n\nfrom random import randint\n\n@dataclass\nclass State:\n        counter: int\n\n@route\ndef index(state: State) -> Page:\n        return Page(state, [Table([\n                ["Welcome to Drafter!",\n                "Click the button below."],\n                [Button("Increase the count", increment_counter, (randint(1,100),))],\n        ])])\n\n@route\ndef increment_counter(state: State, offset: int) -> Page:\n        raise ValueError("aa")\n        state.counter += offset\n        return Page(state, [\n                "You\'ve clicked the button " + str(state.counter) + " times",\n                Button("Click again", increment_counter, (randint(1,100),))\n        ])\n\nprint(__version__)\n\n# print(get_main_server().configuration.debug)\n\ndeploy_site()\n\nget_main_server().configuration.cdn_skulpt = "http://localhost:8080/skulpt.js"\nget_main_server().configuration.cdn_skulpt_std = "http://localhost:8080/skulpt-stdlib.js"\nget_main_server().configuration.cdn_skulpt_drafter = "http://localhost:8080/skulpt-drafter.js"\nget_main_server().configuration.cdn_drafter_setup = "http://localhost:8080/drafter-setup.js"\n\n# get_main_server().configuration.cdn_skulpt = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js"\n# get_main_server().configuration.cdn_skulpt_std = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js"\n# get_main_server().configuration.cdn_skulpt_drafter = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js"\n# get_main_server().configuration.cdn_drafter_setup = "https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js"\n\n# with open("out.js", "w") as f:\n        # # f.write(bundle_py_into_raw_js("/home/rowan/Desktop/CISC/CS1/example_d"))\n        # f.write(bundle_py_into_raw_js("."))\n\nstart_server(State(0))\n\n# if int(__version__.split(".")[0]) < 2:\n        # start_server(State(0))\n#\n# # from _HTMLPage import *\n# # from server import start_server\n# #\n# # set_website_title("Drafter 2 Example / Playground")\n# # add_website_css("div", "width: fit-content; margin: auto;")\n# # add_website_content("<div>HELLO!!</div>")\n# #\n# # print(MAIN_HTML_PAGE)\n# #\n# # start_server()\n#\n# else:\n        # # from flask import Flask\n        # # app = Flask("/")\n        # # @app.route("/")\n        # # def index():\n                # # with open("index.html") as f:\n                        # # return f.read()\n        # # app.run(host="localhost", port=8000)\n#\n        # import http.server as sv\n        # sv.test(sv.SimpleHTTPRequestHandler, sv.ThreadingHTTPServer)\n';

            function compilePython() {
                for (let fileName in pythonSource) {
                    let internalName = fileName.replace(/\.py$/, ".js");
                    let contents = pythonSource[fileName];
                    let co = Sk.compile(contents, `src/student/${fileName}`, 'exec', true, true);
                    Sk.builtinFiles.files[`src/student/${internalName}`] = `${co.code}\nvar $builtinmodule = ${co.funcname};`;
                }
            }

            Sk.output = console.log;
        </script>
    </head>

    <body>
        <div id="website">
            Loading...
        </div>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js" type="text/javascript"></script>
    </body>
</html>
